<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vallejo Paint Tracker</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="data.js"></script>
    <style>
        /* Container styles */
        .paint-group {
            border: 1px solid #d1d5db;
            border-radius: 4px;
            padding: 0.5rem;
            margin-bottom: 0.5rem;
        }
        
        /* Individual paint swatch container */
        .paint-swatch {
            border: 1px solid #e5e7eb;
            border-radius: 4px;
            padding: 0.5rem;
            background: white;
        }
        
        /* Color preview box with fixed aspect ratio */
        .color-block {
            aspect-ratio: 2.975 / 1;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useCallback } = React;

        function App() {
            // ============== State Management ==============
            
            // Main paint data state - initialized from localStorage or defaults
            const [paints, setPaints] = useState(() => {
                try {
                    const saved = localStorage.getItem('vallejo-paint-data');
                    if (saved) {
                        const savedData = JSON.parse(saved);
                        const ownedSet = new Set(savedData.owned || []);
                        const toBuySet = new Set(savedData.toBuy || []);
                        
                        return window.paintData.map(paint => ({
                            ...paint,
                            owned: ownedSet.has(paint.id),
                            toBuy: toBuySet.has(paint.id)
                        }));
                    }
                } catch (error) {
                    console.error('Error loading saved data:', error);
                }
                // Default: all paints unowned and not in wishlist
                return window.paintData.map(paint => ({ 
                    ...paint, 
                    owned: false, 
                    toBuy: false 
                }));
            });

            // UI state
            const [searchTerm, setSearchTerm] = useState('');
            const [showTriads, setShowTriads] = useState(false);
            const [showFilterDropdown, setShowFilterDropdown] = useState(false);
            const [filters, setFilters] = useState({
                owned: false,
                notOwned: false,
                toBuy: false
            });

            // Sync/sharing state
            const [syncStatus, setSyncStatus] = useState('');
            const [showSyncModal, setShowSyncModal] = useState(false);
            const [showLoadConfirm, setShowLoadConfirm] = useState(false);
            const [showResetConfirm, setShowResetConfirm] = useState(false);
            const [pendingHashData, setPendingHashData] = useState('');
            const [manualCode, setManualCode] = useState('');

            // Paint type categories for grouping
            const paintTypes = [
                "Regular", "Metallic", "Ink", "Wash", "Fluo", 
                "Special FX", "Auxiliary", "Xpress", "Xpress Intense"
            ];

            // ============== Effects ==============
            
            // Check for encoded data in URL hash on component mount
            useEffect(() => {
                const hash = window.location.hash.slice(1);
                if (hash && hash.length > 20) {
                    setPendingHashData(hash);
                    setShowLoadConfirm(true);
                }
            }, []);

            // Persist paint data to localStorage whenever it changes
            useEffect(() => {
                try {
                    const dataToSave = {
                        owned: paints.filter(p => p.owned).map(p => p.id),
                        toBuy: paints.filter(p => p.toBuy).map(p => p.id)
                    };
                    localStorage.setItem('vallejo-paint-data', JSON.stringify(dataToSave));
                } catch (error) {
                    console.error('Error saving data:', error);
                }
            }, [paints]);

            // Global escape key handler for closing modals and dropdowns
            useEffect(() => {
                const handleEscape = (e) => {
                    if (e.key === 'Escape') {
                        // Close any open modal/dropdown
                        if (showSyncModal) {
                            setShowSyncModal(false);
                            setManualCode('');
                        }
                        if (showLoadConfirm) {
                            handleCancelLoad();
                        }
                        if (showResetConfirm) {
                            handleCancelReset();
                        }
                        if (showFilterDropdown) {
                            setShowFilterDropdown(false);
                        }
                    }
                };
                
                window.addEventListener('keydown', handleEscape);
                return () => window.removeEventListener('keydown', handleEscape);
            }, [showSyncModal, showLoadConfirm, showResetConfirm, showFilterDropdown]);

            // Click outside handler for filter dropdown
            useEffect(() => {
                if (!showFilterDropdown) return;
                
                const handleClickOutside = (e) => {
                    const dropdown = document.getElementById('filter-dropdown');
                    const button = document.getElementById('filter-dropdown-button');
                    if (dropdown && button && 
                        !dropdown.contains(e.target) && 
                        !button.contains(e.target)) {
                        setShowFilterDropdown(false);
                    }
                };
                
                document.addEventListener('mousedown', handleClickOutside);
                return () => document.removeEventListener('mousedown', handleClickOutside);
            }, [showFilterDropdown]);

            // ============== Paint Management Handlers ==============
            
            /**
             * Toggle paint owned status
             * If marking as owned, automatically remove from wishlist
             */
            const handleToggleOwned = useCallback((id, checked) => {
                setPaints(prev => prev.map(p => 
                    p.id === id 
                        ? { ...p, owned: checked, toBuy: checked ? false : p.toBuy } 
                        : p
                ));
            }, []);

            /**
             * Toggle paint wishlist status
             * Only available for paints not already owned
             */
            const handleToggleWishlist = useCallback((id, checked) => {
                setPaints(prev => prev.map(p => 
                    p.id === id ? { ...p, toBuy: checked } : p
                ));
            }, []);

            // ============== Filter Handlers ==============
            
            /**
             * Handle owned filter toggle
             * Mutually exclusive with "not owned" filter
             */
            const handleOwnedFilter = useCallback((checked) => {
                setFilters(prev => ({
                    ...prev,
                    owned: checked,
                    notOwned: checked ? false : prev.notOwned
                }));
            }, []);

            /**
             * Handle not owned filter toggle
             * Mutually exclusive with "owned" filter
             */
            const handleNotOwnedFilter = useCallback((checked) => {
                setFilters(prev => ({
                    ...prev,
                    notOwned: checked,
                    owned: checked ? false : prev.owned
                }));
            }, []);

            /**
             * Handle wishlist filter toggle
             */
            const handleWishlistFilter = useCallback((checked) => {
                setFilters(prev => ({ ...prev, toBuy: checked }));
            }, []);

            // ============== Data Import/Export Handlers ==============
            
            /**
             * Export current paint collection to JSON file
             */
            const handleExportData = useCallback(() => {
                const dataToExport = {
                    owned: paints.filter(p => p.owned).map(p => p.id),
                    toBuy: paints.filter(p => p.toBuy).map(p => p.id)
                };
                
                const dataStr = JSON.stringify(dataToExport, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', 'vallejo-paints.json');
                linkElement.click();
            }, [paints]);

            /**
             * Import paint collection from JSON file
             */
            const handleImportData = useCallback((event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const imported = JSON.parse(e.target.result);
                        
                        // Validate expected format
                        if (!imported.owned || !Array.isArray(imported.owned)) {
                            throw new Error('Invalid format: expected {owned: [...], toBuy: [...]}');
                        }
                        
                        const ownedSet = new Set(imported.owned);
                        const toBuySet = new Set(imported.toBuy || []);
                        
                        // Update paint states based on imported data
                        setPaints(prev => prev.map(paint => ({
                            ...paint,
                            owned: ownedSet.has(paint.id),
                            toBuy: toBuySet.has(paint.id)
                        })));
                        
                        alert('Data imported successfully!');
                    } catch (error) {
                        alert('Error importing data: ' + error.message);
                    }
                };
                reader.readAsText(file);
                
                // Reset input value to allow re-importing same file
                event.target.value = '';
            }, []);

            /**
             * Reset all paint data - show confirmation first
             */
            const handleResetData = useCallback(() => {
                setShowResetConfirm(true);
            }, []);

            /**
             * Confirm and execute reset
             */
            const handleConfirmReset = useCallback(() => {
                setPaints(prev => prev.map(p => ({ ...p, owned: false, toBuy: false })));
                localStorage.removeItem('vallejo-paint-data');
                setShowResetConfirm(false);
            }, []);

            /**
             * Cancel reset operation
             */
            const handleCancelReset = useCallback(() => {
                setShowResetConfirm(false);
            }, []);

            // ============== Sharing/Sync Handlers ==============
            
            /**
             * Create shareable URL with encoded paint data
             */
            const handleShareToCloud = useCallback(async () => {
                setSyncStatus('Creating share link...');
                try {
                    // Use idx for more compact encoding
                    const dataToShare = {
                        owned: paints.filter(p => p.owned).map(p => p.idx),
                        toBuy: paints.filter(p => p.toBuy).map(p => p.idx)
                    };

                    // Encode data in URL hash
                    const jsonString = JSON.stringify(dataToShare);
                    const encoded = btoa(jsonString);
                    const shareUrl = `${window.location.origin}${window.location.pathname}#${encoded}`;
                    
                    // Copy to clipboard
                    await navigator.clipboard.writeText(shareUrl);
                    
                    setSyncStatus('✓ Link copied to clipboard!');
                    setTimeout(() => setSyncStatus(''), 5000);
                } catch (error) {
                    console.error('Share error:', error);
                    setSyncStatus(`✗ Error: ${error.message}`);
                    setTimeout(() => setSyncStatus(''), 5000);
                }
            }, [paints]);

            /**
             * Load paint data from base64 encoded string
             */
            const loadFromHash = useCallback((encodedData) => {
                setSyncStatus('Loading from URL...');
                try {
                    const jsonString = atob(encodedData);
                    const imported = JSON.parse(jsonString);

                    // Create lookup sets using idx for efficiency
                    const ownedIdxSet = new Set(imported.owned || []);
                    const toBuyIdxSet = new Set(imported.toBuy || []);
                    
                    setPaints(prev => prev.map(paint => ({
                        ...paint,
                        owned: ownedIdxSet.has(paint.idx),
                        toBuy: toBuyIdxSet.has(paint.idx)
                    })));

                    setSyncStatus('✓ Loaded successfully!');
                    setTimeout(() => setSyncStatus(''), 3000);
                    
                    // Clear hash from URL after successful load
                    window.history.replaceState(null, '', window.location.pathname);
                } catch (error) {
                    console.error('Load error:', error);
                    setSyncStatus(`✗ Error loading data: ${error.message}`);
                    setTimeout(() => setSyncStatus(''), 5000);
                }
            }, []);

            /**
             * Handle manual code entry for loading
             */
            const handleManualLoad = useCallback(() => {
                const trimmedCode = manualCode.trim();
                if (trimmedCode.length > 0) {
                    setPendingHashData(trimmedCode);
                    setShowSyncModal(false);
                    setShowLoadConfirm(true);
                    setManualCode('');
                } else {
                    setSyncStatus('✗ Please enter a code');
                    setTimeout(() => setSyncStatus(''), 3000);
                }
            }, [manualCode]);

            /**
             * Confirm loading from hash data
             */
            const handleConfirmLoad = useCallback(() => {
                loadFromHash(pendingHashData);
                setShowLoadConfirm(false);
                setPendingHashData('');
            }, [pendingHashData, loadFromHash]);

            /**
             * Cancel loading operation
             */
            const handleCancelLoad = useCallback(() => {
                setShowLoadConfirm(false);
                setPendingHashData('');
                // Clear hash from URL if present
                if (window.location.hash) {
                    window.history.replaceState(null, '', window.location.pathname);
                }
            }, []);

            // ============== Computed Values ==============
            
            /**
             * Filter paints based on search term and active filters
             */
            const filteredPaints = useMemo(() => {
                let result = [...paints];

                // Apply ownership filters
                if (filters.owned) {
                    result = result.filter(p => p.owned);
                }
                if (filters.notOwned) {
                    result = result.filter(p => !p.owned);
                }
                if (filters.toBuy) {
                    result = result.filter(p => p.toBuy);
                }

                // Apply search filter
                if (searchTerm) {
                    const term = searchTerm.toLowerCase();
                    result = result.filter(p => 
                        p.name.toLowerCase().includes(term) || 
                        p.id.toLowerCase().includes(term)
                    );
                }

                return result;
            }, [paints, filters, searchTerm]);

            /**
             * Group filtered paints by type or show as search results
             */
            const groupedPaints = useMemo(() => {
                if (searchTerm) {
                    // Show flat list when searching
                    return { "Search Results": filteredPaints };
                }

                // Group by paint type
                const grouped = {};
                paintTypes.forEach(type => {
                    const typePaints = filteredPaints.filter(p => p.type === type);
                    if (typePaints.length > 0) {
                        grouped[type] = typePaints;
                    }
                });
                return grouped;
            }, [filteredPaints, searchTerm]);

            /**
             * Calculate collection statistics
             */
            const stats = useMemo(() => ({
                owned: paints.filter(p => p.owned).length,
                toBuy: paints.filter(p => p.toBuy).length,
                total: paints.length
            }), [paints]);

            // ============== Render ==============
            
            return (
                <div className="max-w-7xl mx-auto p-4">
                    {/* Header with title and statistics */}
                    <div className="mb-4 flex justify-between items-center gap-3">
                        <h1 className="text-2xl sm:text-3xl font-bold">Paint Tracker</h1>
                        <div className="flex gap-2 flex-wrap">
                            <span className="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs sm:text-sm whitespace-nowrap">
                                Owned: {stats.owned}/{stats.total}
                            </span>
                            <span className="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs sm:text-sm whitespace-nowrap">
                                Wishlist: {stats.toBuy}
                            </span>
                        </div>
                    </div>

                    {/* Search, filters and action buttons */}
                    <div className="mb-6 flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4">
                        <div className="flex gap-2 flex-1 min-w-0">
                            <input
                                type="text"
                                placeholder="Search by name or ID..."
                                value={searchTerm}
                                onChange={(e) => setSearchTerm(e.target.value)}
                                className="flex-1 min-w-0 p-2 border rounded"
                                aria-label="Search paints"
                            />
                            
                            {/* Filter dropdown */}
                            <div className="relative flex-shrink-0">
                                <button
                                    id="filter-dropdown-button"
                                    onClick={() => setShowFilterDropdown(!showFilterDropdown)}
                                    className="px-3 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 whitespace-nowrap"
                                    aria-expanded={showFilterDropdown}
                                    aria-haspopup="true"
                                >
                                    Filters ▾
                                </button>
                                {showFilterDropdown && (
                                    <div 
                                        id="filter-dropdown"
                                        className="absolute top-full mt-1 right-0 bg-white border border-gray-300 rounded-lg shadow-lg p-3 z-50 min-w-[200px]"
                                        role="menu"
                                    >
                                        <div className="flex flex-col gap-2">
                                            <label className="flex items-center hover:bg-gray-50 p-2 rounded cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={filters.owned}
                                                    onChange={(e) => handleOwnedFilter(e.target.checked)}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">Owned</span>
                                            </label>
                                            <label className="flex items-center hover:bg-gray-50 p-2 rounded cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={filters.notOwned}
                                                    onChange={(e) => handleNotOwnedFilter(e.target.checked)}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">Missing</span>
                                            </label>
                                            <label className="flex items-center hover:bg-gray-50 p-2 rounded cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={filters.toBuy}
                                                    onChange={(e) => handleWishlistFilter(e.target.checked)}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">Wishlist</span>
                                            </label>
                                            <div className="border-t border-gray-200 my-1"></div>
                                            <label className="flex items-center hover:bg-gray-50 p-2 rounded cursor-pointer">
                                                <input
                                                    type="checkbox"
                                                    checked={showTriads}
                                                    onChange={(e) => setShowTriads(e.target.checked)}
                                                    className="mr-2"
                                                />
                                                <span className="text-sm">BSL Triads</span>
                                            </label>
                                        </div>
                                    </div>
                                )}
                            </div>
                        </div>

                        {/* Action buttons */}
                        <div className="flex gap-2 flex-wrap justify-center sm:justify-start">
                            <button 
                                onClick={handleShareToCloud}
                                className="px-3 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 whitespace-nowrap"
                                title="Create a shareable link for other devices"
                            >
                                Share
                            </button>
                            <button 
                                onClick={() => setShowSyncModal(true)}
                                className="px-3 py-2 bg-teal-600 text-white rounded hover:bg-teal-700 whitespace-nowrap"
                                title="Load collection from a code"
                            >
                                Load
                            </button>
                            <button 
                                onClick={handleExportData}
                                className="px-3 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 whitespace-nowrap"
                                title="Export collection to JSON file"
                            >
                                Export
                            </button>
                            <label className="px-3 py-2 bg-green-600 text-white rounded hover:bg-green-700 cursor-pointer whitespace-nowrap">
                                Import
                                <input 
                                    type="file" 
                                    accept=".json"
                                    onChange={handleImportData}
                                    className="hidden"
                                    aria-label="Import JSON file"
                                />
                            </label>
                            <button 
                                onClick={handleResetData}
                                className="px-3 py-2 bg-red-600 text-white rounded hover:bg-red-700 whitespace-nowrap"
                                title="Reset all paint data"
                            >
                                Reset
                            </button>
                        </div>
                    </div>

                    {/* Status message */}
                    {syncStatus && (
                        <div className="mb-4 p-3 bg-blue-50 border border-blue-200 rounded text-sm" role="status">
                            {syncStatus}
                        </div>
                    )}

                    {/* Manual code entry modal */}
                    {showSyncModal && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" role="dialog" aria-modal="true">
                            <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                <h3 className="text-lg font-bold mb-4">Load from Code</h3>
                                <p className="text-sm text-gray-600 mb-4">
                                    Paste the code from the end of your shared URL:
                                </p>
                                <input
                                    type="text"
                                    value={manualCode}
                                    onChange={(e) => setManualCode(e.target.value)}
                                    placeholder="Paste code here..."
                                    className="w-full p-2 border rounded mb-4 font-mono text-xs"
                                    autoFocus
                                />
                                <div className="flex gap-2 justify-end">
                                    <button
                                        onClick={() => {
                                            setShowSyncModal(false);
                                            setManualCode('');
                                        }}
                                        className="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        onClick={handleManualLoad}
                                        className="px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700"
                                    >
                                        Load
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Load confirmation modal */}
                    {showLoadConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" role="dialog" aria-modal="true">
                            <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                <h3 className="text-lg font-bold mb-4">⚠️ Overwrite Collection?</h3>
                                <p className="text-sm text-gray-600 mb-4">
                                    Loading this shared collection will replace your current paint data. 
                                    Consider exporting your current collection first if you want to keep it.
                                </p>
                                <div className="flex gap-2 justify-end">
                                    <button
                                        onClick={handleCancelLoad}
                                        className="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        onClick={handleConfirmLoad}
                                        className="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
                                    >
                                        Replace My Data
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Reset confirmation modal */}
                    {showResetConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50" role="dialog" aria-modal="true">
                            <div className="bg-white rounded-lg p-6 max-w-md w-full">
                                <h3 className="text-lg font-bold mb-4">⚠️ Reset All Data?</h3>
                                <p className="text-sm text-gray-600 mb-4">
                                    This will clear all your owned and wishlist paints. This action cannot be undone.
                                    Consider exporting your collection first if you want to keep a backup.
                                </p>
                                <div className="flex gap-2 justify-end">
                                    <button
                                        onClick={handleCancelReset}
                                        className="px-4 py-2 bg-gray-300 rounded hover:bg-gray-400"
                                    >
                                        Cancel
                                    </button>
                                    <button
                                        onClick={handleConfirmReset}
                                        className="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
                                    >
                                        Reset Everything
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* BSL Triads Section */}
                    {showTriads && (
                        <div className="mb-6 paint-group">
                            <h2 className="text-xl font-bold mb-4">BSL Triads</h2>
                            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2">
                                {window.triads.map((triad, idx) => {
                                    const ownedCount = triad.filter(id => 
                                        paints.find(p => p.id === id)?.owned
                                    ).length;
                                    
                                    // Color code based on completion
                                    const bgColor = ownedCount === 3 ? 'bg-green-100' : 
                                                   ownedCount === 2 ? 'bg-yellow-100' : 
                                                   'bg-white';
                                    
                                    return (
                                        <div 
                                            key={idx} 
                                            className={`${bgColor} border border-gray-200 rounded p-2`}
                                        >
                                            <div className="grid grid-cols-3 gap-2">
                                                {triad.map((paintId) => {
                                                    const paint = paints.find(p => p.id === paintId);
                                                    
                                                    if (!paint) {
                                                        return (
                                                            <div key={`${idx}-${paintId}`} className="paint-swatch">
                                                                <span className="text-xs text-gray-500">Missing</span>
                                                            </div>
                                                        );
                                                    }
                                                    
                                                    return (
                                                        <div key={`${idx}-${paintId}`} className="paint-swatch">
                                                            <div 
                                                                className="color-block mb-1"
                                                                style={{ backgroundColor: paint.color }}
                                                                title={paint.name}
                                                            />
                                                            <div className="text-xs font-semibold">{paint.id}</div>
                                                            <div className="text-xs truncate" title={paint.name}>
                                                                {paint.name}
                                                            </div>
                                                            <div className="text-xs text-gray-500 truncate" title={paint.citadel}>
                                                                {paint.citadel || "N/A"}
                                                            </div>
                                                            <div className="flex gap-2 mt-1">
                                                                <label className="text-xs flex items-center">
                                                                    <input
                                                                        type="checkbox"
                                                                        checked={paint.owned}
                                                                        onChange={(e) => handleToggleOwned(paint.id, e.target.checked)}
                                                                        className="mr-1"
                                                                    />
                                                                    Own
                                                                </label>
                                                                <label className="text-xs flex items-center">
                                                                    <input
                                                                        type="checkbox"
                                                                        checked={paint.toBuy}
                                                                        disabled={paint.owned}
                                                                        onChange={(e) => handleToggleWishlist(paint.id, e.target.checked)}
                                                                        className="mr-1"
                                                                    />
                                                                    Buy
                                                                </label>
                                                            </div>
                                                        </div>
                                                    );
                                                })}
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    )}

                    {/* Main paint grid grouped by type */}
                    <div>
                        {Object.entries(groupedPaints).map(([type, typePaints]) => (
                            <div key={type} className="paint-group">
                                <h2 className="text-xl font-bold mb-4">
                                    {/* Map internal type names to display names */}
                                    {type === "Regular" ? "Game Color" : 
                                     type === "Metallic" ? "Game Color Metallic" :
                                     type === "Ink" ? "Game Color Ink" :
                                     type === "Wash" ? "Game Color Wash" :
                                     type === "Fluo" ? "Game Color Fluo" :
                                     type === "Special FX" ? "Game Color Special FX" :
                                     type === "Auxiliary" ? "Auxiliary Products" :
                                     type === "Xpress" ? "Xpress Color" :
                                     type === "Xpress Intense" ? "Xpress Color Intense" :
                                     type}
                                </h2>
                                <div className="grid grid-cols-3 sm:grid-cols-3 md:grid-cols-6 lg:grid-cols-9 gap-2">
                                    {typePaints.map(paint => (
                                        <div key={paint.id} className="paint-swatch">
                                            <div 
                                                className="color-block mb-1"
                                                style={{ backgroundColor: paint.color }}
                                                title={paint.name}
                                            />
                                            <div className="text-xs font-semibold">{paint.id}</div>
                                            <div className="text-xs truncate" title={paint.name}>
                                                {paint.name}
                                            </div>
                                            <div className="text-xs text-gray-500 truncate" title={paint.citadel}>
                                                {paint.citadel || "N/A"}
                                            </div>
                                            <div className="flex gap-2 mt-1">
                                                <label className="text-xs flex items-center">
                                                    <input
                                                        type="checkbox"
                                                        checked={paint.owned}
                                                        onChange={(e) => handleToggleOwned(paint.id, e.target.checked)}
                                                        className="mr-1"
                                                    />
                                                    Own
                                                </label>
                                                <label className="text-xs flex items-center">
                                                    <input
                                                        type="checkbox"
                                                        checked={paint.toBuy}
                                                        disabled={paint.owned}
                                                        onChange={(e) => handleToggleWishlist(paint.id, e.target.checked)}
                                                        className="mr-1"
                                                    />
                                                    Buy
                                                </label>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>